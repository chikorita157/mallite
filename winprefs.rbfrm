#tag WindowBegin Window winprefs   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   269   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   False   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Preferences"   Visible         =   True   Width           =   607   Begin TabPanel TabPanel1      AutoDeactivate  =   True      Bold            =   ""      Enabled         =   True      Height          =   261      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   8      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Panels          =   ""      Scope           =   0      SmallTabs       =   ""      TabDefinition   =   "General\rMelative"      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   0      Underline       =   ""      Value           =   1      Visible         =   True      Width           =   588      Begin StaticText StaticText1         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   74         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   1         Text            =   "Login"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   48         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin CheckBox CheckBox1         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Enable Automatic Login"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   74         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         State           =   0         TabIndex        =   1         TabPanelIndex   =   1         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   72         Underline       =   ""         Value           =   False         Visible         =   True         Width           =   212      End      Begin StaticText StaticText10         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   33         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   95         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   True         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   1         Text            =   "Enabling this option will make MAL Lite log you in automatically using your stored password. If Remember Password isn't checked, this option cannot be enabled."         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   96         Underline       =   ""         Visible         =   True         Width           =   465      End      Begin StaticText StaticText12         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   54         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   2         Text            =   "Melative"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   51         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin StaticText StaticText6         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   47         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   54         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   2         Text            =   "Enabling this option will post a update automatically when you update your MAL Status. Your account must be verified before this option can be chosen. Then a Auth token will be created."         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   71         Underline       =   ""         Visible         =   True         Width           =   499      End      Begin PushButton PushButton2         AutoDeactivate  =   True         Bold            =   ""         Cancel          =   ""         Caption         =   "Remove Tokens"         Default         =   ""         Enabled         =   True         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   411         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   122         Underline       =   ""         Visible         =   True         Width           =   117      End      Begin TextField TextField1         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         BackColor       =   16777215         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   159         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   3         TabPanelIndex   =   2         TabStop         =   True         Text            =   ""         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   122         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   218      End      Begin StaticText StaticText5         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   55         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   2         Text            =   "Username:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   124         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin StaticText StaticText4         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   54         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         TabIndex        =   5         TabPanelIndex   =   2         Text            =   "Password:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   155         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin TextField TextField2         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         BackColor       =   16777215         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   159         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Mask            =   ""         Password        =   True         ReadOnly        =   ""         Scope           =   0         TabIndex        =   6         TabPanelIndex   =   2         TabStop         =   True         Text            =   ""         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   154         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   218      End      Begin PushButton vert         AutoDeactivate  =   True         Bold            =   ""         Cancel          =   ""         Caption         =   "Verify"         Default         =   ""         Enabled         =   True         Height          =   21         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   411         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         TabIndex        =   7         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   154         Underline       =   ""         Visible         =   True         Width           =   117      End      Begin StaticText StaticText11         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   12         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   368         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   True         Scope           =   0         TabIndex        =   8         TabPanelIndex   =   2         Text            =   "Get a Melative Account"         TextAlign       =   0         TextColor       =   204         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   188         Underline       =   True         Visible         =   True         Width           =   160      End      Begin CheckBox enableupdating         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Enable Melative Updating"         DataField       =   ""         DataSource      =   ""         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   55         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         State           =   0         TabIndex        =   9         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   188         Underline       =   ""         Value           =   False         Visible         =   True         Width           =   301      End      Begin StaticText token         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   51         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         TabIndex        =   10         TabPanelIndex   =   2         Text            =   "Your Token is:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   216         Underline       =   ""         Visible         =   True         Width           =   150      End   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  		  if booleanrememberpassword = false then		    checkbox1.enabled = false		  else		    		  end if		  		  If prefs.StringMelAuth = "" then		    enableupdating.enabled = false		  else		    enableupdating.enabled = true		  end if		End Sub	#tag EndEvent	#tag MenuHandler		Function EditPreferences() As Boolean Handles EditPreferences.Action			winprefs.show			Return True					End Function	#tag EndMenuHandler#tag EndWindowCode#tag Events CheckBox1	#tag Event		Sub Open()		  checkbox1.value = booleanautologin		End Sub	#tag EndEvent	#tag Event		Sub Action()		  booleanautologin = checkbox1.value		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton2	#tag Event		Sub Action()		  Dim d as New MessageDialog //declare the MessageDialog object		  Dim b as MessageDialogButton //for handling the result		  d.icon=MessageDialog.GraphicCaution //display warning icon		  d.ActionButton.Caption="Remove"		  d.CancelButton.Visible=True    //show the Cancel button		  d.Message="Are you sure you want to remove your Melative Auth token?"		  d.Explanation="Once removed, this operation cannot be undone."		  b=d.ShowModal //display the dialog		  Select Case b //determine which button was pressed.		  Case d.ActionButton		    //user pressed remove		    Prefs.StringmelAuth = ""		    enableupdating.state = checkbox.checkedstates.Unchecked		    enableupdating.enabled = false		    prefs.BooleanMelUpdates = false		    token.text =  "Your token is: " + StringMelAuth		  Case d.CancelButton		    //user pressed Cancel		  End select		End Sub	#tag EndEvent#tag EndEvents#tag Events vert	#tag Event		Sub Action()		  If TextField1.text = ""  then		    // no username error		    app.errboxshow("Vertification failed!","You need to enter a username. ")		  else		    If Textfield2.text="" then		      // no password error		      app.errboxshow("Vertification failed!","You need to enter a password. ")		    else		      // using API to check credentials		      dim data as string		      dim socket1 as new httpsocket		      socket1.yield=true		      // create and populate the form object		      dim form as New Dictionary		      form.value("user") = TextField1.text		      form.value("password") = TextField2.text		      // setup the socket to POST the form		      socket1.setFormData form		      data = socket1.post("http://melative.com/api/login.xml",10)		      If socket1.httpstatuscode = 200 then		        // login is a success		        // Store Password and Username		        prefs.StringmelAuth =  EncodeBase64(TextField1.text + ":" + TextField2.text)		        enableupdating.enabled = true		        token.text =  "Your token is: " + StringMelAuth		      Else		        // if login fails		        app.errboxshow("Vertification failed!","Incorrect Username or Password. Check your Username and Password.")		      end if		    end if		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events StaticText11	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  showurl "http://melative.com/register"		End Function	#tag EndEvent#tag EndEvents#tag Events enableupdating	#tag Event		Sub Action()		  prefs.BooleanMelUpdates = me.value		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.value = booleanmelupdates		End Sub	#tag EndEvent#tag EndEvents#tag Events token	#tag Event		Sub Open()		  me.text = "Your token is: " + StringMelAuth		End Sub	#tag EndEvent#tag EndEvents